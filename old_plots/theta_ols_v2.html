<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>theta_OLS vs N — A078567</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Oxanium:wght@300;400;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: #05080f;
    color: #c4d4e8;
    font-family: 'Oxanium', sans-serif;
    min-height: 100vh;
    display: flex; flex-direction: column;
    padding: 32px 36px 48px;
    gap: 24px;
  }
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image:
      linear-gradient(rgba(0,200,255,0.022) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,200,255,0.022) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events: none; z-index: 0;
  }
  .header { position: relative; z-index: 1; border-left: 3px solid #00c8ff; padding-left: 18px; }
  .header h1 { font-size: 1.45rem; font-weight: 700; letter-spacing: 0.04em; color: #fff; text-transform: uppercase; }
  .header h1 em { color: #00c8ff; font-style: normal; }
  .header .sub { font-size: 0.75rem; font-family: 'Source Code Pro', monospace; color: #5a7a9a; margin-top: 5px; letter-spacing: 0.05em; }

  .tabs { position: relative; z-index: 1; display: flex; gap: 6px; }
  .tab {
    padding: 7px 18px; border-radius: 3px; border: 1px solid #1e3040;
    background: transparent; color: #5a7a9a; cursor: pointer;
    font-family: 'Source Code Pro', monospace; font-size: 11px; letter-spacing: 0.07em;
    text-transform: uppercase; transition: all 0.15s;
  }
  .tab:hover { border-color: #00c8ff44; color: #8ab8d8; }
  .tab.active { background: rgba(0,200,255,0.08); border-color: #00c8ff66; color: #00c8ff; }

  .chart-card {
    position: relative; z-index: 1;
    background: rgba(8,14,26,0.85);
    border: 1px solid rgba(0,200,255,0.1);
    border-radius: 8px;
    padding: 24px 24px 16px;
  }
  .chart-title { font-size: 10px; letter-spacing: 0.14em; text-transform: uppercase; color: #5a7a9a; margin-bottom: 14px; }
  .chart-wrap { position: relative; }

  .two-col { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  @media(max-width:800px) { .two-col { grid-template-columns: 1fr; } }

  .legend {
    display: flex; gap: 20px; flex-wrap: wrap;
    margin-top: 12px;
    font-size: 11px; font-family: 'Source Code Pro', monospace; color: #5a7a9a;
  }
  .legend-item { display: flex; align-items: center; gap: 7px; }
  .ld { width: 22px; height: 2px; display: inline-block; }

  .obs {
    position: relative; z-index: 1;
    display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
  }
  @media(max-width:800px) { .obs { grid-template-columns: 1fr; } }

  .obs-card {
    background: rgba(0,200,255,0.03);
    border: 1px solid rgba(0,200,255,0.1);
    border-radius: 6px;
    padding: 14px 18px;
    font-family: 'Source Code Pro', monospace;
    font-size: 11.5px; line-height: 1.85; color: #7a9ab8;
  }
  .obs-card strong { color: #c4d4e8; }
  .obs-card .hl  { color: #00c8ff; }
  .obs-card .hl2 { color: #ffaa44; }
  .obs-card .hl3 { color: #ff6688; }
  .obs-card code { background: rgba(0,200,255,0.07); padding: 1px 5px; border-radius: 2px; color: #8ab8d8; }

  .stat-row { position: relative; z-index: 1; display: flex; gap: 14px; flex-wrap: wrap; }
  .stat {
    background: rgba(0,200,255,0.04); border: 1px solid rgba(0,200,255,0.1);
    border-radius: 4px; padding: 8px 16px;
    display: flex; flex-direction: column; gap: 2px;
  }
  .stat .lbl { font-size: 9px; letter-spacing: 0.12em; text-transform: uppercase; color: #5a7a9a; }
  .stat .val  { font-size: 1rem; font-weight: 600; color: #e0eeff; font-family: 'Source Code Pro', monospace; }
</style>
</head>
<body>

<div class="header">
  <h1><em>theta</em><sub>OLS</sub>(N) — A078567 / a_hoying(n)</h1>
  <div class="sub">
    log|err_osc| ~ α·log(n) + C &nbsp;·&nbsp; theta_OLS = α − 0.5 &nbsp;·&nbsp;
    N = 10^18 &nbsp;·&nbsp; 34,555 sample points &nbsp;·&nbsp; ratio = 1.001
  </div>
</div>

<div class="stat-row" id="statRow"></div>

<div class="tabs">
  <button class="tab active" onclick="showView('full')">full range</button>
  <button class="tab" onclick="showView('zoom')">zoomed  10¹⁰–10¹⁸</button>
  <button class="tab" onclick="showView('extrap')">extrapolation</button>
  <button class="tab" onclick="showView('diffs')">Δ per decade</button>
</div>

<!-- FULL RANGE -->
<div id="view-full" class="chart-card" style="display:block">
  <div class="chart-title">theta_OLS — full range 10⁴ to 10¹⁸</div>
  <div class="chart-wrap" style="height:400px"><canvas id="cFull"></canvas></div>
  <div class="legend" id="legFull"></div>
</div>

<!-- ZOOM -->
<div id="view-zoom" class="chart-card" style="display:none">
  <div class="chart-title">theta_OLS — zoomed in on the plateau: 10¹⁰ – 10¹⁸</div>
  <div class="chart-wrap" style="height:400px"><canvas id="cZoom"></canvas></div>
  <div class="legend" id="legZoom"></div>
</div>

<!-- EXTRAPOLATION -->
<div id="view-extrap" class="chart-card" style="display:none">
  <div class="chart-title">Fitted models extrapolated to 10⁴⁰ — two possible limits</div>
  <div class="chart-wrap" style="height:400px"><canvas id="cExtrap"></canvas></div>
  <div class="legend" id="legExtrap"></div>
</div>

<!-- DIFFS -->
<div id="view-diffs" class="chart-card" style="display:none">
  <div class="chart-title">Δ theta_OLS per decade — rate of change slowing to near-zero</div>
  <div class="chart-wrap" style="height:400px"><canvas id="cDiffs"></canvas></div>
</div>

<div class="obs">
  <div class="obs-card">
    <strong>What the curve is doing</strong><br>
    theta_OLS crossed 0.25 at around N = 10¹³ and has been
    hovering near <span class="hl">0.2514</span> for the last five decades.
    The last two steps were <code>+0.000755</code>, <code>−0.000178</code>,
    <code>−0.000027</code> — essentially flat. This is either genuine convergence
    to a fixed value slightly above 0.25, or extremely slow drift that won't
    resolve at accessible N.
  </div>
  <div class="obs-card">
    <strong>Two fitted extrapolation models</strong><br>
    Fit on k = 9–18, predicting the k → ∞ limit:<br>
    <span class="hl">θ(k) = A + B/k</span> &nbsp;→&nbsp; A ≈ <span class="hl">0.2585</span><br>
    <span class="hl2">θ(k) = A + B/k + C/k²</span> &nbsp;→&nbsp; A ≈ <span class="hl2">0.2544</span><br><br>
    Both models are sensitive to noise in the data — the true limit could
    reasonably be anywhere from 0.25 to 0.26. The conjecture (θ = 0.25) is
    not ruled out; it would just require the curve to eventually bend back down.
  </div>
  <div class="obs-card">
    <strong>Why OLS overestimates θ</strong><br>
    With ratio 1.001, there are ~2300 sample points per decade. Because the
    regression is OLS over <em>all</em> points equally, the dense forest of small-n
    points (which have noisier, smaller err_osc) dominates over the sparse
    large-n points (which carry the most information about true scaling).
    This systematically biases α — and therefore θ — upward.
    A weighted regression or envelope regression would likely give a lower estimate.
  </div>
  <div class="obs-card">
    <strong>Context</strong><br>
    <span class="hl3">Huxley proven bound:</span> θ ≤ 131/416 ≈ 0.3149<br>
    <span class="hl">Divisor conjecture:</span> θ = 0.25<br>
    <span class="hl2">This OLS estimate:</span> ~0.2514 and plateau-ing<br><br>
    The OLS curve is well below Huxley and tantalizingly close to 0.25.
    Whether the true limit is exactly 0.25 or something slightly above it
    is exactly the open problem.
  </div>
</div>

<script>
const D = {"ks": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "thetas": [0.22184065656130558, 0.23937493957029643, 0.24090142075899423, 0.24010857476575564, 0.2430367947058485, 0.24571016741109386, 0.24639494845310494, 0.247486654895136, 0.24909386708235692, 0.2501918017955057, 0.2505789775925802, 0.2508173187163625, 0.25157217817911637, 0.25139416083007315, 0.2513669072914695], "npts": [2303, 4607, 6911, 9213, 11517, 13821, 16125, 18428, 20732, 23036, 25340, 27642, 29946, 32250, 34555], "diffs": [null, 0.017534283008990847, 0.0015264811886978036, -0.000792845993238589, 0.0029282199400928466, 0.0026733727052453693, 0.0006847810420110845, 0.0010917064420310485, 0.00160721218722093, 0.0010979347131487849, 0.00038717579707447936, 0.000238341123782293, 0.0007548594627538874, -0.00017801734904321354, -2.7253538603666527e-05], "diff_ks": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "k_ext": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "ext1": [0.21978490405645132, 0.22945979892405421, 0.23526473584461596, 0.23913469379165714, 0.2418989494681151, 0.24397214122545857, 0.2455846237033924, 0.24687460968573946, 0.24793005276220523, 0.24880958865926003, 0.24955381134138332, 0.250191716497489, 0.25074456763278063, 0.2512283123761608, 0.2516551459732609, 0.25203455361512767, 0.25237402361048217, 0.2526795466063012, 0.252955972173947, 0.2532072681445341, 0.25343671229159187, 0.2536470360930615, 0.25384053399041356, 0.2540191474341231, 0.25418453025237275, 0.254338100012176, 0.25448107875406173, 0.2546145255798218, 0.25473936293295213, 0.2548563979515118, 0.2549663399386437, 0.2550698147500619, 0.25516737671511336, 0.25525951857099527, 0.25534667978601877, 0.2554292535686725, 0.2555075927983697, 0.25558201506658207], "ext2": [0.18033773859179747, 0.21196889509627342, 0.22675291994417252, 0.23486115773661081, 0.23979670125064093, 0.24303020385772753, 0.24526772512786982, 0.24688296426670095, 0.2480889679407642, 0.24901452651280961, 0.24974128116986058, 0.2503230572470308, 0.25079653300435273, 0.2511874165405877, 0.2515141707461981, 0.25179033969062287, 0.2520260464729144, 0.2522289837413303, 0.25240508439726056, 0.2525589854229368, 0.2526943547694909, 0.2528141257018571, 0.2529206674213254, 0.2530159110580427, 0.253101443916317, 0.25317858081326916, 0.25324841867189146, 0.2533118787237424, 0.2533697394407131, 0.253422662457551, 0.2534712131436078, 0.2535158770528506, 0.2535570731719603, 0.2535951646613096, 0.25363046761819785, 0.2536632582689877, 0.25369377890491346, 0.2537222428069863], "A1": 0.25848448352686293, "B1": -0.11609873841123482, "A2": 0.25442900142486985, "B2": -0.0125403357598914, "C2": -0.629200358217977};

const CONJ   = 0.25;
const HUXLEY = 131/416;

const SCALE_DEFAULTS = {
  x: {
    type: 'linear',
    ticks: { color:'#5a7a9a', font:{family:"'Source Code Pro'",size:10}, callback: v=>`10^${v}`, stepSize:1 },
    grid: { color:'rgba(0,200,255,0.06)' },
    title: { display:true, text:'log₁₀(N)', color:'#5a7a9a', font:{family:"'Source Code Pro'",size:10} }
  },
  y: {
    ticks: { color:'#5a7a9a', font:{family:"'Source Code Pro'",size:10}, callback: v=>v.toFixed(4) },
    grid: { color:'rgba(0,200,255,0.06)' },
    title: { display:true, text:'theta_OLS', color:'#5a7a9a', font:{family:"'Source Code Pro'",size:10} }
  }
};

const TOOLTIP_BASE = {
  backgroundColor:'#0a1220', borderColor:'rgba(0,200,255,0.25)', borderWidth:1,
  titleColor:'#7ab8d8', bodyColor:'#c4d4e8',
  titleFont:{family:"'Source Code Pro'",size:11}, bodyFont:{family:"'Source Code Pro'",size:11},
};

function refLine(ks, y) {
  return ks.map(k => ({x:k, y}));
}

function makeMainTooltip() {
  return {
    ...TOOLTIP_BASE,
    callbacks: {
      title: c => `N = 10^${c[0].parsed.x}`,
      label: c => {
        if (c.datasetIndex !== 0) return null;
        const i = c.dataIndex;
        const pts = D.npts[i] || '—';
        return [
          `theta_OLS = ${c.parsed.y.toFixed(7)}`,
          `alpha     = ${(c.parsed.y+0.5).toFixed(7)}`,
          `pts used  = ${typeof pts==='number' ? pts.toLocaleString() : pts}`,
          `vs 0.25   = ${(c.parsed.y-0.25>=0?'+':'')}${(c.parsed.y-0.25).toFixed(6)}`,
        ];
      }
    }
  };
}

// ── FULL RANGE ────────────────────────────────────────────────────────────────
(function() {
  const ctx = document.getElementById('cFull').getContext('2d');
  const pts  = D.ks.map((k,i) => ({x:k, y:D.thetas[i]}));
  new Chart(ctx, {
    type: 'line', data: { datasets: [
      { label:'theta_OLS', data:pts, borderColor:'#00c8ff', backgroundColor:'rgba(0,200,255,0.06)',
        borderWidth:2, pointRadius:4, pointBackgroundColor:'#00c8ff',
        pointBorderColor:'#05080f', pointBorderWidth:1.5, fill:false, tension:0.2, order:1 },
      { label:'θ=0.25', data:refLine(D.ks,CONJ), borderColor:'rgba(255,68,102,0.65)',
        borderWidth:1.5, borderDash:[6,4], pointRadius:0, fill:false, order:2 },
      { label:'Huxley', data:refLine(D.ks,HUXLEY), borderColor:'rgba(255,170,68,0.65)',
        borderWidth:1.5, borderDash:[3,4], pointRadius:0, fill:false, order:3 },
    ]},
    options: {
      responsive:true, maintainAspectRatio:false, parsing:false,
      animation:{duration:400},
      plugins:{ legend:{display:false}, tooltip:makeMainTooltip() },
      scales: SCALE_DEFAULTS,
    }
  });
  document.getElementById('legFull').innerHTML = legendHTML(['theta_OLS','θ = 0.25 (conjecture)','θ ≤ 131/416 (Huxley)'],
    ['#00c8ff','rgba(255,68,102,0.8)','rgba(255,170,68,0.8)']);
})();

// ── ZOOM ─────────────────────────────────────────────────────────────────────
(function() {
  const ctx = document.getElementById('cZoom').getContext('2d');
  const i0  = D.ks.indexOf(10);
  const pts  = D.ks.slice(i0).map((k,i) => ({x:k, y:D.thetas[i0+i]}));
  const ksZ  = D.ks.slice(i0);

  // tight y range
  const ymin = 0.2455, ymax = 0.2530;

  new Chart(ctx, {
    type: 'line', data: { datasets: [
      { label:'theta_OLS', data:pts, borderColor:'#00c8ff', backgroundColor:'rgba(0,200,255,0.08)',
        borderWidth:2.5, pointRadius:5, pointBackgroundColor:'#00c8ff',
        pointBorderColor:'#05080f', pointBorderWidth:2, fill:false, tension:0, order:1 },
      { label:'θ=0.25', data:refLine(ksZ,CONJ), borderColor:'rgba(255,68,102,0.75)',
        borderWidth:1.5, borderDash:[6,4], pointRadius:0, fill:false, order:2 },
    ]},
    options: {
      responsive:true, maintainAspectRatio:false, parsing:false,
      animation:{duration:400},
      plugins:{ legend:{display:false}, tooltip:makeMainTooltip() },
      scales: {
        ...SCALE_DEFAULTS,
        y: { ...SCALE_DEFAULTS.y, min:ymin, max:ymax,
             ticks:{...SCALE_DEFAULTS.y.ticks, callback:v=>v.toFixed(4)} }
      }
    }
  });
  document.getElementById('legZoom').innerHTML = legendHTML(['theta_OLS (10¹⁰–10¹⁸)','θ = 0.25'],
    ['#00c8ff','rgba(255,68,102,0.8)']);
})();

// ── EXTRAPOLATION ─────────────────────────────────────────────────────────────
(function() {
  const ctx  = document.getElementById('cExtrap').getContext('2d');
  const obs  = D.ks.map((k,i) => ({x:k, y:D.thetas[i]}));
  const ext1 = D.k_ext.map((k,i) => ({x:k, y:D.ext1[i]}));
  const ext2 = D.k_ext.map((k,i) => ({x:k, y:D.ext2[i]}));
  const allK = D.k_ext;

  new Chart(ctx, {
    type: 'line', data: { datasets: [
      { label:'observed', data:obs, borderColor:'#00c8ff', backgroundColor:'rgba(0,200,255,0.08)',
        borderWidth:2, pointRadius:3.5, pointBackgroundColor:'#00c8ff',
        pointBorderColor:'#05080f', pointBorderWidth:1.5, fill:false, tension:0, order:1 },
      { label:'A+B/k fit', data:ext1, borderColor:'rgba(100,220,140,0.8)',
        borderWidth:1.5, borderDash:[5,3], pointRadius:0, fill:false, order:2 },
      { label:'A+B/k+C/k² fit', data:ext2, borderColor:'rgba(255,180,80,0.8)',
        borderWidth:1.5, borderDash:[3,3], pointRadius:0, fill:false, order:3 },
      { label:'θ=0.25', data:refLine(allK,CONJ), borderColor:'rgba(255,68,102,0.55)',
        borderWidth:1, borderDash:[6,5], pointRadius:0, fill:false, order:4 },
    ]},
    options: {
      responsive:true, maintainAspectRatio:false, parsing:false,
      animation:{duration:400},
      plugins:{ legend:{display:false}, tooltip:{
        ...TOOLTIP_BASE,
        callbacks:{
          title: c=>`N = 10^${c[0].parsed.x}`,
          label: c=>`${['observed','A+B/k','A+B/k+C/k²','θ=0.25'][c.datasetIndex]}: ${c.parsed.y.toFixed(6)}`
        }
      }},
      scales: {
        ...SCALE_DEFAULTS,
        x: {...SCALE_DEFAULTS.x, min:3, max:40,
            title:{display:true,text:'log₁₀(N)  (extrapolated →)',color:'#5a7a9a',font:{family:"'Source Code Pro'",size:10}}},
        y: {...SCALE_DEFAULTS.y, min:0.18, max:0.30}
      }
    }
  });
  document.getElementById('legExtrap').innerHTML = legendHTML(
    ['observed','A+B/k  (limit ≈ 0.2585)','A+B/k+C/k²  (limit ≈ 0.2544)','θ = 0.25'],
    ['#00c8ff','rgba(100,220,140,0.9)','rgba(255,180,80,0.9)','rgba(255,68,102,0.7)']);
})();

// ── DIFFS ─────────────────────────────────────────────────────────────────────
(function() {
  const ctx = document.getElementById('cDiffs').getContext('2d');
  const pts = D.diff_ks
    .map((k,i) => D.diffs[i] !== null ? {x:k, y:D.diffs[i]} : null)
    .filter(Boolean);

  const barColors = pts.map(p => p.y >= 0 ? 'rgba(0,200,255,0.6)' : 'rgba(255,68,102,0.6)');

  new Chart(ctx, {
    type: 'bar', data: { datasets: [{
      label:'Δtheta per decade',
      data: pts,
      backgroundColor: barColors,
      borderColor: barColors.map(c=>c.replace('0.6','0.9')),
      borderWidth: 1,
      borderRadius: 2,
    }]},
    options: {
      responsive:true, maintainAspectRatio:false, parsing:false,
      animation:{duration:400},
      plugins:{ legend:{display:false}, tooltip:{
        ...TOOLTIP_BASE,
        callbacks:{
          title: c=>`10^${c[0].parsed.x-1} → 10^${c[0].parsed.x}`,
          label: c=>`Δtheta = ${c.parsed.y>=0?'+':''}${c.parsed.y.toFixed(6)}`
        }
      }},
      scales: {
        x: { type:'linear', ticks:{color:'#5a7a9a',font:{family:"'Source Code Pro'",size:10},callback:v=>`10^${v}`,stepSize:1},
             grid:{color:'rgba(0,200,255,0.06)'},
             title:{display:true,text:'decade N',color:'#5a7a9a',font:{family:"'Source Code Pro'",size:10}} },
        y: { ticks:{color:'#5a7a9a',font:{family:"'Source Code Pro'",size:10},callback:v=>v.toFixed(4)},
             grid:{color:'rgba(0,200,255,0.06)'},
             title:{display:true,text:'Δ theta_OLS',color:'#5a7a9a',font:{family:"'Source Code Pro'",size:10}} }
      }
    }
  });
})();

// ── Stat row ──────────────────────────────────────────────────────────────────
const final_t = D.thetas[D.thetas.length-1];
[
  ['Max N', '10^18'],
  ['Sample pts', (34555).toLocaleString()],
  ['Final theta_OLS', final_t.toFixed(6)],
  ['vs conjecture', (final_t-0.25>=0?'+':'')+((final_t-0.25).toFixed(6))],
  ['Last Δ/decade', D.diffs[D.diffs.length-1].toExponential(2)],
].forEach(([lbl,val]) => {
  document.getElementById('statRow').innerHTML +=
    `<div class="stat"><span class="lbl">${lbl}</span><span class="val">${val}</span></div>`;
});

// ── Tab switching ─────────────────────────────────────────────────────────────
function showView(id) {
  ['full','zoom','extrap','diffs'].forEach(v => {
    document.getElementById('view-'+v).style.display = v===id ? 'block' : 'none';
  });
  document.querySelectorAll('.tab').forEach((t,i) => {
    t.classList.toggle('active', ['full','zoom','extrap','diffs'][i]===id);
  });
}

function legendHTML(labels, colors) {
  return labels.map((l,i) =>
    `<div class="legend-item"><span class="ld" style="background:${colors[i]}"></span>${l}</div>`
  ).join('');
}
</script>
</body>
</html>
